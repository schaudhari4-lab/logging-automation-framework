{
  "properties": {
    "displayName": "CS-Postgres-Security-Log-Aggregation",
    "policyType": "Custom",
    "mode": "All",
    "metadata": {
      "version": "1.0.0",
      "createdBy": "9e2f9255-3d43-4bdd-86c5-351daef6cbe6",
      "createdOn": "2025-08-06T10:38:37.3542085Z",
      "updatedBy": "9e2f9255-3d43-4bdd-86c5-351daef6cbe6",
      "updatedOn": "2025-08-20T08:31:13.6315722Z"
    },
    "version": "1.0.0",
    "parameters": {},
    "policyRule": {
      "if": {
        "field": "type",
        "equals": "Microsoft.DBforPostgreSQL/flexibleServers"
      },
      "then": {
        "effect": "AuditIfNotExists",
        "details": {
          "type": "Microsoft.Insights/diagnosticSettings",
          "existenceCondition": {
            "field": "name",
            "equals": "CS-pgdiag"
          }
        }
      }
    },
    "versions": [
      "1.0.0"
    ]
  },
  "id": "/subscriptions/391c8a4e-5460-4de0-947c-c60eb3dd48ef/providers/Microsoft.Authorization/policyDefinitions/aefee340-2977-4677-80e9-d20660ef4720",
  "type": "Microsoft.Authorization/policyDefinitions",
  "name": "aefee340-2977-4677-80e9-d20660ef4720",
  "systemData": {
    "createdBy": "adm-SChaudhari4@slb.com",
    "createdByType": "User",
    "createdAt": "2025-08-06T10:38:37.2928443Z",
    "lastModifiedBy": "adm-SChaudhari4@slb.com",
    "lastModifiedByType": "User",
    "lastModifiedAt": "2025-08-20T08:31:13.5919855Z"
  }
}